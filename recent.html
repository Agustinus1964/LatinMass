<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Katolik Terbaru - eTradWorld</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Lato', sans-serif; }
        .font-cinzel { font-family: 'Cinzel', serif; }
        .gradient-bg {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
        }
        .gold-gradient {
            background: linear-gradient(135deg, #d4af37 0%, #f4e4bc 50%, #d4af37 100%);
        }
        .video-item:hover {
            background-color: rgba(251, 191, 36, 0.1);
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <!-- Header -->
    <header class="py-6 border-b border-amber-600/30">
        <div class="container mx-auto px-4">
            <a href="index.html" class="flex items-center justify-center">
                <div class="w-12 h-12 rounded-full gold-gradient flex items-center justify-center mr-3">
                    <span class="text-2xl">✝</span>
                </div>
                <h1 class="font-cinzel text-3xl md:text-4xl font-bold text-amber-400">eTradWorld</h1>
            </a>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8 max-w-4xl">
        <div class="text-center mb-8">
            <h2 class="font-cinzel text-2xl md:text-3xl text-amber-300 mb-2">Video Katolik Terbaru</h2>
            <p id="lastUpdated" class="text-slate-400 text-sm"></p>
        </div>

        <!-- Loading State -->
        <div id="loadingState" class="flex flex-col items-center justify-center py-20">
            <div class="w-16 h-16 border-4 border-amber-400 border-t-transparent rounded-full animate-spin mb-4"></div>
            <p class="text-amber-200">Memuat video...</p>
        </div>

        <!-- Error State -->
        <div id="errorState" class="hidden flex flex-col items-center justify-center py-20">
            <svg class="w-20 h-20 text-red-500 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
            </svg>
            <p class="text-red-400 text-lg mb-2">Gagal Memuat Data</p>
            <button onclick="loadVideos()" class="mt-4 bg-amber-600 hover:bg-amber-500 text-white px-6 py-2 rounded-lg transition">
                Coba Lagi
            </button>
        </div>

        <!-- Video List -->
        <div id="videoList" class="hidden space-y-3">
        </div>

        <!-- Back Button -->
        <div class="mt-12 text-center">
            <a href="index.html" class="inline-flex items-center text-amber-400 hover:text-amber-300 transition">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                </svg>
                Kembali ke Halaman Utama
            </a>
        </div>
    </main>

    <!-- Footer -->
    <footer class="border-t border-amber-600/20 py-6 mt-auto">
        <div class="container mx-auto px-4 text-center text-amber-200/50 text-sm">
            <p>✝ eTradWorld - Menyatukan Umat Katolik Tradisional ✝</p>
            <p class="mt-1">Ad Majorem Dei Gloriam</p>
        </div>
    </footer>

    <script>
        const DATA_URL = 'data/recent-videos.json';

        async function loadVideos() {
            const loadingState = document.getElementById('loadingState');
            const errorState = document.getElementById('errorState');
            const videoList = document.getElementById('videoList');
            
            loadingState.classList.remove('hidden');
            errorState.classList.add('hidden');
            videoList.classList.add('hidden');
            
            try {
                const response = await fetch(DATA_URL + '?t=' + Date.now());
                if (!response.ok) throw new Error('Failed to load data');
                
                const data = await response.json();
                
                // Update last updated
                const lastUpdated = new Date(data.lastUpdated);
                document.getElementById('lastUpdated').textContent = 
                    `Diperbarui: ${lastUpdated.toLocaleString('id-ID')}`;
                
                // Render videos
                if (data.videos.length === 0) {
                    videoList.innerHTML = `
                        <div class="text-center py-10">
                            <p class="text-slate-400">Tidak ada video terbaru</p>
                        </div>
                    `;
                } else {
                    videoList.innerHTML = data.videos.map((video, index) => `
                        <a href="https://www.youtube.com/watch?v=${video.id}" target="_blank" 
                           class="video-item flex items-start gap-4 p-4 rounded-lg border border-slate-700 hover:border-amber-500/50 transition block">
                            <span class="text-amber-400/50 font-mono text-sm w-8 flex-shrink-0">${index + 1}.</span>
                            <div class="flex-1 min-w-0">
                                <h3 class="text-white font-medium mb-1 line-clamp-2">${escapeHtml(video.title)}</h3>
                                <div class="flex flex-wrap items-center gap-2 text-sm">
                                    <span class="text-amber-400/70">${escapeHtml(video.channel)}</span>
                                    <span class="text-slate-500">•</span>
                                    <span class="text-slate-400">${formatDate(video.publishedAt)}</span>
                                    ${video.category ? `
                                        <span class="text-slate-500">•</span>
                                        <span class="text-purple-400/70 text-xs px-2 py-0.5 bg-purple-500/10 rounded">${escapeHtml(video.category)}</span>
                                    ` : ''}
                                </div>
                            </div>
                            <svg class="w-5 h-5 text-slate-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
                            </svg>
                        </a>
                    `).join('');
                }
                
                loadingState.classList.add('hidden');
                videoList.classList.remove('hidden');
                
            } catch (error) {
                console.error('Error loading videos:', error);
                loadingState.classList.add('hidden');
                errorState.classList.remove('hidden');
            }
        }

        function formatDate(isoString) {
            const date = new Date(isoString);
            const now = new Date();
            const diffMs = now - date;
            const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
            const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
            
            if (diffHours < 1) {
                return 'Baru saja';
            } else if (diffHours < 24) {
                return `${diffHours} jam lalu`;
            } else if (diffDays < 7) {
                return `${diffDays} hari lalu`;
            } else {
                return date.toLocaleDateString('id-ID', { day: 'numeric', month: 'short', year: 'numeric' });
            }
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadVideos();
        });
    </script>
</body>
</html>
